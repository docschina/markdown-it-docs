(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{176:function(t,s,n){"use strict";n.r(s);var a=n(0),e=Object(a.a)({},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),n("p",[t._v("参考 "),n("a",{attrs:{href:"https://github.com/markdown-it/markdown-it/blob/master/lib/token.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("token class"),n("OutboundLink")],1),t._v("\n以获得关于每个 token 内容的细节。")]),t._v(" "),n("p",[t._v("总之，一个 token 流是：")]),t._v(" "),t._m(11),t._v(" "),n("p",[t._v("为什么不是 AST？因为我们的任务不需要它。我们遵循 KISS 原则。\n如果你愿意的话 - 你可以在没有渲染器的情况下调用解析器并转换 tokens 流到 AST。")]),t._v(" "),n("p",[t._v("更多关于 tokens 的细节：")]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://github.com/markdown-it/markdown-it/blob/master/lib/renderer.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("Renderer 源码"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/markdown-it/markdown-it/blob/master/lib/token.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("Token 源码"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://markdown-it.github.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("在线示例"),n("OutboundLink")],1),t._v(" - 输入你的文本然后点击 "),n("code",[t._v("debug")]),t._v(" tab。")])]),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),n("p",[t._v("Rules 通过 "),n("router-link",{attrs:{to:"./api/Ruler.html"}},[t._v("Ruler")]),t._v(" 实例按名称管理，并且可以被 "),n("router-link",{attrs:{to:"./MarkdownIt.html"}},[t._v("MarkdownIt")]),t._v(" 方法 "),n("code",[t._v("enabled")]),t._v(" / "),n("code",[t._v("disabled")]),t._v("。")],1),t._v(" "),t._m(14),t._v(" "),n("p",[t._v("这是一个重要的设计原则 - token 流在块和内联解析阶段是“只写的”。")]),t._v(" "),n("p",[t._v("解析器旨在使规则彼此独立。你可以安全地启用/禁用它们，或者添加新的。\n关于如何创建新规则没有通用的方法 - 设计具有良好数据隔离的分布式状态机是一项棘手的业务。但是你可以调查现有规则和插件，以查看可能的方法。")]),t._v(" "),n("p",[t._v("此外，在复杂的情况下，你可以尝试在跟踪器(tracker)中寻求帮助。这种情况是很简单的 - 从你的 ticket 上可以清楚地看到，你研究过文档，源码，并尝试自己做一些事情。我们绝不会拒绝真正的开发人员。")]),t._v(" "),t._m(15),t._v(" "),n("p",[t._v("生成 token 流后，将其传递给 "),n("a",{attrs:{href:"https://github.com/markdown-it/markdown-it/blob/master/lib/renderer.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("renderer"),n("OutboundLink")],1),t._v("。\n然后它会遍历所有 token，将每个token 传递给与 token 的 type 属性同名的规则。")]),t._v(" "),t._m(16),t._v(" "),t._m(17),n("p",[t._v("在许多情况下，即使在没有解析器侵入的情况下，也可以轻松地进行输出更改。\n例如，让我们替换 img 和 video 链接成播放器的 iframe")]),t._v(" "),t._m(18),t._m(19),t._v(" "),t._m(20),n("p",[t._v("注意，如果你需要添加属性，你可以不需要覆盖渲染器来做这些事。\n例如，你能够在 "),n("code",[t._v("core")]),t._v(" 链中更新 tokens。这比直接覆盖渲染器慢，但这更简单。让我们使用 "),n("a",{attrs:{href:"https://github.com/markdown-it/markdown-it-for-inline",target:"_blank",rel:"noopener noreferrer"}},[t._v("markdown-for-inline"),n("OutboundLink")],1),t._v(" 插件来做同样的事情，就像之前的例子一样：")]),t._v(" "),t._m(21),n("p",[t._v("你也能够编写你自己的渲染器来生成其他除了 HTML 的格式，像 JSON/XML... 你甚至能够使用它来生成 AST。")]),t._v(" "),t._m(22),t._v(" "),t._m(23),t._v(" "),t._m(24),t._v(" "),n("p",[t._v("介于两者之间你可以应用额外的转换:)。全部内容\n可见于每个链的顶部\n"),n("a",{attrs:{href:"https://github.com/markdown-it/markdown-it/blob/master/lib/parser_core.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("parser_core.js"),n("OutboundLink")],1),t._v(",\n"),n("a",{attrs:{href:"https://github.com/markdown-it/markdown-it/blob/master/lib/parser_block.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("parser_block.js"),n("OutboundLink")],1),t._v(" 和\n"),n("a",{attrs:{href:"https://github.com/markdown-it/markdown-it/blob/master/lib/parser_inline.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("parser_inline.js"),n("OutboundLink")],1),t._v("\n文件。")]),t._v(" "),n("p",[t._v("你也可以直接在 "),n("a",{attrs:{href:"https://github.com/markdown-it/markdown-it/blob/master/lib/renderer.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("renderer"),n("OutboundLink")],1),t._v(" 中更改输出，以解决许多简单的情况。")])])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"markdown-it-设计准则"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#markdown-it-设计准则","aria-hidden":"true"}},[this._v("#")]),this._v(" markdown-it 设计准则")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"数据流"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#数据流","aria-hidden":"true"}},[this._v("#")]),this._v(" 数据流")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("输入数据通过嵌套的规则链来解析。有三种嵌套的链 -\n"),s("code",[this._v("core")]),this._v(", "),s("code",[this._v("block")]),this._v(" 和 "),s("code",[this._v("inline")]),this._v("：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("core\n    core.rule1 (normalize)\n    ...\n    core.ruleX\n\n    block\n        block.rule1 (blockquote)\n        ...\n        block.ruleX\n\n    core.ruleX1 (应用在块 tokens 的中间层规则，不算什么)\n    ...\n    core.ruleXX\n\n    inline (应用于内联类型的每个块 token)\n        inline.rule1 (text)\n        ...\n        inline.ruleX\n\n    core.ruleYY (应用于所有 tokens)\n    ... (abbreviation, footnote, typographer, linkifier)\n\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("解析的结果是一个 "),s("em",[this._v("list tokens")]),this._v("，它将被传递给 "),s("code",[this._v("renderer")]),this._v(" 来生成 html 内容。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("这些 tokens 能被自身解析来生成更多的 tokens。（例如：一个 "),s("code",[this._v("list token")]),this._v(" 能被拆分为多个内联 tokens）。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("一个 "),s("code",[this._v("env")]),this._v(" 沙盒能被用来与 tokens 来给你的解析器和渲染器注入额外的变量。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("当解析数据时，每个链（core / block / inline）会使用一个独立的 "),s("code",[this._v("state")]),this._v(" 对象，所以每个解析中的操作都是独立的，并且能在运行时被禁用。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"token-流"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#token-流","aria-hidden":"true"}},[this._v("#")]),this._v(" Token 流")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("不像传统的 AST，我们使用更加底层的数据代表 - "),s("em",[this._v("tokens")]),this._v("。\n不同之处一目了然：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("Tokens 是一个简单的序列（数组）。")]),this._v(" "),s("li",[this._v("打开的和关闭的标签是隔离的。")]),this._v(" "),s("li",[this._v("有特殊的 token 对象，比如“内联容器(inline container)”，它有嵌套的 tokens。")]),this._v(" "),s("li",[this._v("一系列内联的标签（粗体，斜体，文本等等）")])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ul",[n("li",[t._v("在顶层 - 是成对或单个“块” tokens 的数组：\n"),n("ul",[n("li",[t._v("打开的/关闭的标题，列表，块引用，段落，...")]),t._v(" "),n("li",[t._v("代码，围栏块，水平规则，html 块，内联容器")])])]),t._v(" "),n("li",[t._v("每个内联 token 都有一个"),n("code",[t._v(".children")]),t._v(" 属性，带有嵌套 token 流，用于内联内容：\n"),n("ul",[n("li",[t._v("打开的/关闭的 strong 强调，em 强调，链接，代码，...")]),t._v(" "),n("li",[t._v("文字，换行符")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"规则-rules"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#规则-rules","aria-hidden":"true"}},[this._v("#")]),this._v(" 规则(Rules)")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("p",[t._v("Rules 是用解析器的 "),n("code",[t._v("state")]),t._v(" 对象做“有魔力的事情”的函数。一个唯一的规则会与一个或多个"),n("strong",[t._v("链")]),t._v("相关联。例如，"),n("code",[t._v("blockquote")]),t._v(" 标记与 "),n("code",[t._v("blockquote")]),t._v("，"),n("code",[t._v("paragraph")]),t._v("，"),n("code",[t._v("heading")]),t._v(" 和 "),n("code",[t._v("list")]),t._v(" 链相关联。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("你可以注意到，某些规则具有 "),s("code",[this._v("validation mode")]),this._v(" - 在此模式下规则不能修改 token 流，只能查看 token 的结尾。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"渲染器-renderer"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#渲染器-renderer","aria-hidden":"true"}},[this._v("#")]),this._v(" 渲染器(Renderer)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("渲染器规则位于 "),s("code",[this._v("md.renderer.rules [name]")]),this._v(" ，是简单的具有相同特征的函数：")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("tokens"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" idx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" renderer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" htmlResult"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" md "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'markdown-it'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" defaultRender "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" md"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("renderer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rules"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("image"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    vimeoRE       "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/^https?:\\/\\/(www\\.)?vimeo.com\\/(\\d+)($|\\/)/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("renderer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rules"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("image")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("tokens"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" idx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" self")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" token "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tokens"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("idx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      aIndex "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" token"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("attrIndex")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'src'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vimeoRE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("token"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attrs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("aIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" token"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attrs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("aIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("match")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vimeoRE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<div class=\"embed-responsive embed-responsive-16by9\">\\n'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n           "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'  <iframe class="embed-responsive-item" src="//player.vimeo.com/video/\'')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\"></iframe>\\n'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n           "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'</div>\\n'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 传递 token 给默认的渲染器。")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("defaultRender")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tokens"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" idx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("这里是其他的示例，如何添加 "),s("code",[this._v('target="_blank"')]),this._v(" 到所有链接：")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果覆盖，或者是对默认渲染器的代理，则记住老的渲染器。")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" defaultRender "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" md"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("renderer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rules"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("link_open "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("tokens"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" idx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" self")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("renderToken")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tokens"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" idx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("renderer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rules"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("link_open")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("tokens"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" idx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" self")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果你确认其他的插件不能添加 `target` - 放弃以下检查：")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" aIndex "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tokens"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("idx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("attrIndex")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'target'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("aIndex "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    tokens"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("idx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("attrPush")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'target'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'_blank'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 添加新属性")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    tokens"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("idx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attrs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("aIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'_blank'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 替换已经存在的属性值")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 传递 token 到默认的渲染器。")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("defaultRender")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tokens"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" idx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" iterator "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'markdown-it-for-inline'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" md "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'markdown-it'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("iterator"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'url_new_win'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'link_open'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("tokens"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" idx")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n              "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" aIndex "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tokens"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("idx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("attrIndex")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'target'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n              "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("aIndex "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                tokens"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("idx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("attrPush")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'target'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'_blank'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n              "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                tokens"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("idx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attrs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("aIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'_blank'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n              "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结","aria-hidden":"true"}},[this._v("#")]),this._v(" 总结")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("这在 "),s("a",{attrs:{href:"#%E6%95%B0%E6%8D%AE%E6%B5%81"}},[this._v("数据流")]),this._v(" 中提到过，但让我们再重复序列一次：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[this._v("解析块，并使用块 token 填充顶层 token 流。")]),this._v(" "),s("li",[this._v("解析内联容器上的内容，填充 "),s("code",[this._v(".children")]),this._v(" 属性。")]),this._v(" "),s("li",[this._v("渲染过程。")])])}],!1,null,null,null);s.default=e.exports}}]);